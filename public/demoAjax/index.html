<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>[TDW] ACiencia - Demo AJAX </title>
    <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
    <script src="./codigo.js"></script>
</head>
<body>
    <form method="post" id="form-login">
        <label for="username">Usuario: </label>
        <input type="text" id="username" name="username" placeholder="Usuario" autofocus/>
        <label for="password">Contrase√±a: </label>
        <input type="password" id="password" name="password" placeholder="Palabra clave"/>
        <input type="button" id="btn-login" value="Login" />
    </form>
    <hr/>
    <code><span id="resultado"></span></code>

<script>
    logout();
    let authHeader = null;
    $("#btn-login").click(function(){
        $.post(
            "/access_token",
            $("#form-login").serialize(),
            null
        ).success(function (data, textStatus, request) {
            // Si es correcto => mostrar pagina
            authHeader = request.getResponseHeader('Authorization');
            guardarToken(authHeader);
            guardarUsername($("#username").val());
            guardarRol();
            let rol = sessionStorage.getItem('rol');
            console.log(rol);
            debugger;
            if(rol == "writer"){
                window.location.replace("./SHOWED_INDEX.html");
            }else{
                window.location.replace("./OPENED_INDEX.html");
            }

        }).fail(function () {
            alert("Incorrecto :(")
        });
    });
</script>
</body>
</html>